<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>CitySize - Discover How Big Your City Really Is!</title>
    <style>
        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --accent: #FFE66D;
            --success: #95E77E;
            --info: #748FFC;
            --dark: #2C3E50;
            --light: #F8F9FA;
            --gradient-fun: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-surprise: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-home: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --shadow-soft: 0 2px 10px rgba(0,0,0,0.08);
            --shadow-medium: 0 4px 20px rgba(0,0,0,0.12);
            --shadow-large: 0 10px 40px rgba(0,0,0,0.15);
            --radius: 20px;
            --radius-small: 12px;
            --safe-bottom: env(safe-area-inset-bottom, 20px);
            --transition: cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--light);
            color: var(--dark);
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }

        /* Fun animated background */
        .background-decoration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 0;
            opacity: 0.03;
            background-image: 
                radial-gradient(circle at 20% 80%, var(--primary) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, var(--secondary) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, var(--accent) 0%, transparent 50%);
        }

        /* Main App Container */
        .app-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Splash/Welcome Screen */
        .welcome-screen {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .welcome-screen.hidden {
            display: none;
        }

        .city-emoji-cloud {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            font-size: 40px;
        }

        .city-emoji {
            position: absolute;
            animation: float 20s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            33% { transform: translateY(-30px) rotate(5deg); }
            66% { transform: translateY(20px) rotate(-5deg); }
        }

        .app-logo {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .welcome-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .welcome-subtitle {
            font-size: 18px;
            opacity: 0.95;
            margin-bottom: 40px;
            line-height: 1.4;
        }

        /* Home City Input */
        .home-city-card {
            background: white;
            border-radius: var(--radius);
            padding: 25px;
            width: 100%;
            max-width: 350px;
            box-shadow: var(--shadow-large);
            transform: translateY(0);
            transition: transform 0.3s var(--transition);
        }

        .home-city-card:active {
            transform: translateY(2px);
        }

        .input-label {
            color: var(--dark);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 10px;
            display: block;
        }

        .city-input-group {
            position: relative;
        }

        .city-input {
            width: 100%;
            padding: 15px 45px 15px 20px;
            border: 2px solid #E2E8F0;
            border-radius: var(--radius-small);
            font-size: 16px;
            transition: all 0.3s;
            background: white;
        }

        .city-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.1);
        }

        .location-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--gradient-home);
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
            color: white;
            font-size: 18px;
        }

        .location-btn:active {
            transform: translateY(-50%) scale(0.9);
        }

        .or-divider {
            text-align: center;
            margin: 20px 0;
            color: rgba(255,255,255,0.8);
            font-size: 14px;
        }

        .surprise-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            border-radius: var(--radius-small);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);
        }

        .surprise-btn:active {
            transform: scale(0.95);
        }

        /* Main Screen */
        .main-screen {
            display: none;
            min-height: 100vh;
            flex-direction: column;
            background: var(--light);
        }

        .main-screen.active {
            display: flex;
        }

        /* Header */
        .app-header {
            background: white;
            padding: 15px 20px;
            box-shadow: var(--shadow-soft);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .user-city-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            background: var(--gradient-home);
            border-radius: 25px;
            color: white;
            font-weight: 600;
            font-size: 14px;
        }

        .change-city-btn {
            background: transparent;
            border: none;
            color: var(--primary);
            font-size: 24px;
            cursor: pointer;
        }

        /* Fun Discovery Section */
        .discovery-section {
            padding: 20px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--dark);
        }

        .section-subtitle {
            font-size: 14px;
            color: #64748B;
            margin-bottom: 20px;
        }

        /* Surprise Cards */
        .surprise-cards-container {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 10px;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }

        .surprise-cards-container::-webkit-scrollbar {
            display: none;
        }

        .surprise-card {
            flex: 0 0 280px;
            background: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow-medium);
            cursor: pointer;
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }

        .surprise-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-surprise);
        }

        .surprise-card:active {
            transform: scale(0.95);
        }

        .surprise-emoji {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .surprise-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .surprise-description {
            font-size: 14px;
            color: #64748B;
            line-height: 1.4;
            margin-bottom: 15px;
        }

        .surprise-action {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: 15px;
            border-top: 1px solid #F1F5F9;
        }

        .surprise-stat {
            font-size: 12px;
            color: #94A3B8;
        }

        .explore-btn {
            padding: 8px 16px;
            background: var(--gradient-fun);
            border: none;
            border-radius: 20px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        /* Quick Compare Section */
        .quick-compare-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .quick-compare-card {
            background: white;
            border-radius: var(--radius-small);
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow-soft);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .quick-compare-card::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .quick-compare-card:active::after {
            opacity: 1;
        }

        .compare-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .compare-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
        }

        .compare-sublabel {
            font-size: 12px;
            color: #94A3B8;
            margin-top: 5px;
        }

        /* City Selection Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: flex-end;
            z-index: 1000;
        }

        .modal-overlay.active {
            display: flex;
        }

        .city-selector-modal {
            background: white;
            width: 100%;
            max-height: 85vh;
            border-radius: var(--radius) var(--radius) 0 0;
            animation: slideUp 0.3s var(--transition);
            display: flex;
            flex-direction: column;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .modal-handle {
            width: 40px;
            height: 4px;
            background: #CBD5E1;
            border-radius: 2px;
            margin: 12px auto;
        }

        .modal-header {
            padding: 0 20px 20px;
            border-bottom: 1px solid #F1F5F9;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .search-input-modal {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #E2E8F0;
            border-radius: var(--radius-small);
            font-size: 16px;
        }

        .category-tabs {
            display: flex;
            gap: 10px;
            padding: 15px 20px;
            overflow-x: auto;
            background: #F8FAFC;
            scrollbar-width: none;
        }

        .category-tabs::-webkit-scrollbar {
            display: none;
        }

        .category-tab {
            padding: 8px 16px;
            background: white;
            border: 1px solid #E2E8F0;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
        }

        .category-tab.active {
            background: var(--gradient-fun);
            color: white;
            border-color: transparent;
        }

        .cities-grid {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .city-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: white;
            border-radius: var(--radius-small);
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }

        .city-option:active {
            border-color: var(--primary);
            transform: scale(0.95);
        }

        .city-option-emoji {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .city-option-name {
            font-size: 13px;
            font-weight: 600;
            color: var(--dark);
            text-align: center;
        }

        .city-option-country {
            font-size: 11px;
            color: #94A3B8;
            margin-top: 2px;
        }

        /* Comparison View */
        .comparison-view {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 2000;
            display: none;
            flex-direction: column;
        }

        .comparison-view.active {
            display: flex;
        }

        .comparison-header {
            background: var(--gradient-fun);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .comparison-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .vs-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .city-comparison-badge {
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 25px;
            font-weight: 600;
        }

        .vs-text {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent);
        }

        .comparison-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .size-visual {
            position: relative;
            height: 300px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .city-shape {
            position: absolute;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: white;
            transition: all 0.5s var(--transition);
        }

        .city-shape.base {
            background: rgba(79, 172, 254, 0.8);
            z-index: 1;
        }

        .city-shape.overlay {
            background: rgba(255, 107, 107, 0.8);
            z-index: 2;
        }

        .fun-fact-card {
            background: var(--gradient-surprise);
            color: white;
            padding: 20px;
            border-radius: var(--radius);
            margin: 20px 0;
            text-align: center;
        }

        .fun-fact-emoji {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .fun-fact-text {
            font-size: 16px;
            line-height: 1.4;
        }

        .comparison-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: #F8FAFC;
            padding: 15px;
            border-radius: var(--radius-small);
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            color: #64748B;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark);
        }

        .close-comparison-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .share-btn {
            width: 100%;
            padding: 18px;
            background: var(--gradient-fun);
            border: none;
            border-radius: var(--radius-small);
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
        }

        /* Loading Animation */
        .loading-spinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3000;
        }

        .loading-spinner.active {
            display: block;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(0,0,0,0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Success Animation */
        .success-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: white;
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow-large);
            text-align: center;
            z-index: 3000;
            transition: transform 0.3s var(--transition);
        }

        .success-popup.active {
            transform: translate(-50%, -50%) scale(1);
        }

        .success-emoji {
            font-size: 64px;
            margin-bottom: 15px;
            animation: celebrate 0.5s ease-out;
        }

        @keyframes celebrate {
            0% { transform: scale(0) rotate(0); }
            50% { transform: scale(1.2) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); }
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
            padding: 10px 0 calc(10px + var(--safe-bottom));
            display: flex;
            justify-content: space-around;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: var(--gradient-fun);
            border-radius: 2px;
        }

        .nav-icon {
            font-size: 24px;
            margin-bottom: 4px;
            transition: transform 0.2s;
        }

        .nav-item:active .nav-icon {
            transform: scale(0.9);
        }

        .nav-label {
            font-size: 11px;
            font-weight: 500;
            color: #64748B;
        }

        .nav-item.active .nav-label {
            color: var(--dark);
        }

        /* Pulse Animation for CTAs */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Responsive adjustments */
        @media (min-width: 768px) {
            .app-container {
                max-width: 428px;
                margin: 0 auto;
                box-shadow: var(--shadow-large);
            }
        }
    </style>
</head>
<body>
    <div class="background-decoration"></div>
    
    <div class="app-container">
        <!-- Welcome/Onboarding Screen -->
        <div class="welcome-screen" id="welcomeScreen">
            <div class="city-emoji-cloud">
                <span class="city-emoji" style="top: 10%; left: 10%;">üèôÔ∏è</span>
                <span class="city-emoji" style="top: 20%; left: 80%;">üåÜ</span>
                <span class="city-emoji" style="top: 60%; left: 15%;">üåÉ</span>
                <span class="city-emoji" style="top: 70%; left: 70%;">üèõÔ∏è</span>
                <span class="city-emoji" style="top: 40%; left: 50%;">üåá</span>
            </div>
            
            <div class="app-logo">üåç</div>
            <h1 class="welcome-title">CitySize</h1>
            <p class="welcome-subtitle">Discover surprising size comparisons<br>between your city and others!</p>
            
            <div class="home-city-card">
                <label class="input-label">Start with your city</label>
                <div class="city-input-group">
                    <input type="text" class="city-input" id="homeCityInput" placeholder="Enter your city name...">
                    <button class="location-btn" onclick="detectLocation()">üìç</button>
                </div>
            </div>
            
            <div class="or-divider">‚Äî or ‚Äî</div>
            
            <button class="surprise-btn pulse" onclick="surpriseMe()">
                üé≤ Surprise Me!
            </button>
        </div>

        <!-- Main Screen -->
        <div class="main-screen" id="mainScreen">
            <header class="app-header">
                <div class="header-content">
                    <div class="user-city-badge">
                        <span>üìç</span>
                        <span id="userCityName">San Francisco</span>
                    </div>
                    <button class="change-city-btn" onclick="changeHomeCity()">‚úèÔ∏è</button>
                </div>
            </header>

            <!-- Fun Discovery Section -->
            <div class="discovery-section">
                <h2 class="section-title">üéØ Cities That Will Surprise You!</h2>
                <p class="section-subtitle">Based on San Francisco</p>
                
                <div class="surprise-cards-container">
                    <div class="surprise-card" onclick="compareWith('Tokyo')">
                        <div class="surprise-emoji">üò≤</div>
                        <div class="surprise-title">Mind-Blowing Size</div>
                        <div class="surprise-description">Tokyo is 3.5x larger than SF but feels more compact!</div>
                        <div class="surprise-action">
                            <span class="surprise-stat">2,194 km¬≤</span>
                            <button class="explore-btn">Explore</button>
                        </div>
                    </div>
                    
                    <div class="surprise-card" onclick="compareWith('Singapore')">
                        <div class="surprise-emoji">ü§ù</div>
                        <div class="surprise-title">Your City Twin</div>
                        <div class="surprise-description">Singapore is almost identical in size to San Francisco!</div>
                        <div class="surprise-action">
                            <span class="surprise-stat">728 km¬≤</span>
                            <button class="explore-btn">Compare</button>
                        </div>
                    </div>
                    
                    <div class="surprise-card" onclick="compareWith('Vatican City')">
                        <div class="surprise-emoji">üîç</div>
                        <div class="surprise-title">Tiny but Mighty</div>
                        <div class="surprise-description">Vatican City fits 2,800 times in San Francisco!</div>
                        <div class="surprise-action">
                            <span class="surprise-stat">0.44 km¬≤</span>
                            <button class="explore-btn">See How</button>
                        </div>
                    </div>
                    
                    <div class="surprise-card" onclick="compareWith('Paris')">
                        <div class="surprise-emoji">ü•ê</div>
                        <div class="surprise-title">Smaller Than Expected</div>
                        <div class="surprise-description">Paris city is actually smaller than SF!</div>
                        <div class="surprise-action">
                            <span class="surprise-stat">105 km¬≤</span>
                            <button class="explore-btn">Discover</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Compare Actions -->
            <div class="discovery-section">
                <h2 class="section-title">üöÄ Quick Comparisons</h2>
                <div class="quick-compare-grid">
                    <div class="quick-compare-card" onclick="findSimilarCities()">
                        <div class="compare-icon">üëØ</div>
                        <div class="compare-label">Find Similar</div>
                        <div class="compare-sublabel">Cities your size</div>
                    </div>
                    
                    <div class="quick-compare-card" onclick="compareNeighbors()">
                        <div class="compare-icon">üèòÔ∏è</div>
                        <div class="compare-label">Neighbors</div>
                        <div class="compare-sublabel">Nearby cities</div>
                    </div>
                    
                    <div class="quick-compare-card" onclick="compareCapitals()">
                        <div class="compare-icon">üèõÔ∏è</div>
                        <div class="compare-label">Capitals</div>
                        <div class="compare-sublabel">World capitals</div>
                    </div>
                    
                    <div class="quick-compare-card" onclick="guessingGame()">
                        <div class="compare-icon">üéÆ</div>
                        <div class="compare-label">Guess Size!</div>
                        <div class="compare-sublabel">Fun challenge</div>
                    </div>
                </div>
            </div>

            <!-- Fun Facts -->
            <div class="discovery-section">
                <h2 class="section-title">üí° Did You Know?</h2>
                <div class="fun-fact-card">
                    <div class="fun-fact-emoji">ü§Ø</div>
                    <div class="fun-fact-text">
                        Your city, San Francisco, could fit inside Los Angeles County 
                        <strong>34 times!</strong> But has similar population density!
                    </div>
                </div>
            </div>

            <!-- Bottom Navigation -->
            <nav class="bottom-nav">
                <div class="nav-item active" onclick="switchTab('home')">
                    <span class="nav-icon">üè†</span>
                    <span class="nav-label">Home</span>
                </div>
                <div class="nav-item" onclick="switchTab('explore')">
                    <span class="nav-icon">üó∫Ô∏è</span>
                    <span class="nav-label">Explore</span>
                </div>
                <div class="nav-item" onclick="switchTab('favorites')">
                    <span class="nav-icon">‚≠ê</span>
                    <span class="nav-label">Favorites</span>
                </div>
                <div class="nav-item" onclick="switchTab('share')">
                    <span class="nav-icon">üéÅ</span>
                    <span class="nav-label">Share</span>
                </div>
            </nav>
        </div>

        <!-- City Selection Modal -->
        <div class="modal-overlay" id="cityModal">
            <div class="city-selector-modal">
                <div class="modal-handle"></div>
                <div class="modal-header">
                    <h3 class="modal-title">Choose a City to Compare</h3>
                    <input type="text" class="search-input-modal" placeholder="Search 238 cities...">
                </div>
                
                <div class="category-tabs">
                    <div class="category-tab active">All</div>
                    <div class="category-tab">Americas</div>
                    <div class="category-tab">Europe</div>
                    <div class="category-tab">Asia</div>
                    <div class="category-tab">Africa</div>
                    <div class="category-tab">Oceania</div>
                    <div class="category-tab">Megacities</div>
                </div>
                
                <div class="cities-grid">
                    <div class="city-option" onclick="selectCity('New York')">
                        <span class="city-option-emoji">üóΩ</span>
                        <span class="city-option-name">New York</span>
                        <span class="city-option-country">USA</span>
                    </div>
                    <div class="city-option" onclick="selectCity('London')">
                        <span class="city-option-emoji">üá¨üáß</span>
                        <span class="city-option-name">London</span>
                        <span class="city-option-country">UK</span>
                    </div>
                    <div class="city-option" onclick="selectCity('Tokyo')">
                        <span class="city-option-emoji">üóæ</span>
                        <span class="city-option-name">Tokyo</span>
                        <span class="city-option-country">Japan</span>
                    </div>
                    <div class="city-option" onclick="selectCity('Paris')">
                        <span class="city-option-emoji">üóº</span>
                        <span class="city-option-name">Paris</span>
                        <span class="city-option-country">France</span>
                    </div>
                    <div class="city-option" onclick="selectCity('Sydney')">
                        <span class="city-option-emoji">ü¶ò</span>
                        <span class="city-option-name">Sydney</span>
                        <span class="city-option-country">Australia</span>
                    </div>
                    <div class="city-option" onclick="selectCity('Dubai')">
                        <span class="city-option-emoji">üèúÔ∏è</span>
                        <span class="city-option-name">Dubai</span>
                        <span class="city-option-country">UAE</span>
                    </div>
                    <div class="city-option" onclick="selectCity('Singapore')">
                        <span class="city-option-emoji">ü¶Å</span>
                        <span class="city-option-name">Singapore</span>
                        <span class="city-option-country">Singapore</span>
                    </div>
                    <div class="city-option" onclick="selectCity('Barcelona')">
                        <span class="city-option-emoji">üèñÔ∏è</span>
                        <span class="city-option-name">Barcelona</span>
                        <span class="city-option-country">Spain</span>
                    </div>
                    <div class="city-option" onclick="selectCity('Amsterdam')">
                        <span class="city-option-emoji">üö≤</span>
                        <span class="city-option-name">Amsterdam</span>
                        <span class="city-option-country">Netherlands</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Comparison View -->
        <div class="comparison-view" id="comparisonView">
            <div class="comparison-header">
                <button class="close-comparison-btn" onclick="closeComparison()">‚úï</button>
                <h2 class="comparison-title">Size Comparison</h2>
                <div class="vs-display">
                    <div class="city-comparison-badge" id="baseCity">San Francisco</div>
                    <span class="vs-text">VS</span>
                    <div class="city-comparison-badge" id="overlayCity">Tokyo</div>
                </div>
            </div>
            
            <div class="comparison-content">
                <div class="size-visual">
                    <div class="city-shape base" id="baseShape">
                        <span>SF</span>
                    </div>
                    <div class="city-shape overlay" id="overlayShape">
                        <span>TYO</span>
                    </div>
                </div>
                
                <div class="fun-fact-card">
                    <div class="fun-fact-emoji">üéØ</div>
                    <div class="fun-fact-text" id="comparisonFact">
                        Tokyo is 3.5 times larger than San Francisco!
                        That's like combining SF with Oakland, San Jose, and more!
                    </div>
                </div>
                
                <div class="comparison-stats">
                    <div class="stat-card">
                        <div class="stat-label">Size Ratio</div>
                        <div class="stat-value" id="sizeRatio">3.5x</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Population</div>
                        <div class="stat-value" id="popRatio">15.8x</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Density</div>
                        <div class="stat-value" id="densityRatio">4.5x</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Fun Fact</div>
                        <div class="stat-value">ü§Ø</div>
                    </div>
                </div>
                
                <button class="share-btn" onclick="shareComparison()">
                    üì§ Share This Comparison
                </button>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div class="loading-spinner" id="loadingSpinner">
            <div class="spinner"></div>
        </div>

        <!-- Success Popup -->
        <div class="success-popup" id="successPopup">
            <div class="success-emoji">üéâ</div>
            <h3>Comparison Saved!</h3>
            <p>Added to your favorites</p>
        </div>
    </div>

    <script>
        // App State
        let currentHomeCity = null;
        let currentCompareCity = null;
        let favorites = [];

        // City Data (simplified for demo)
        const cityData = {
            'San Francisco': { area: 600, population: 815000, emoji: 'üåâ' },
            'New York': { area: 783, population: 8336000, emoji: 'üóΩ' },
            'Tokyo': { area: 2194, population: 13960000, emoji: 'üóæ' },
            'Paris': { area: 105, population: 2165000, emoji: 'üóº' },
            'London': { area: 1572, population: 8982000, emoji: 'üá¨üáß' },
            'Singapore': { area: 728, population: 5686000, emoji: 'ü¶Å' },
            'Sydney': { area: 12368, population: 5312000, emoji: 'ü¶ò' },
            'Barcelona': { area: 101, population: 1636000, emoji: 'üèñÔ∏è' },
            'Dubai': { area: 4114, population: 3331000, emoji: 'üèúÔ∏è' },
            'Amsterdam': { area: 219, population: 872000, emoji: 'üö≤' },
            'Vatican City': { area: 0.44, population: 825, emoji: '‚õ™' }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // Check for saved home city
            const savedCity = localStorage.getItem('homeCity');
            if (savedCity) {
                setHomeCity(savedCity);
                showMainScreen();
            }
            
            // Add swipe to close for modal
            setupSwipeGestures();
            
            // Add haptic feedback support
            setupHapticFeedback();
        });

        // Home City Input
        document.getElementById('homeCityInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const city = e.target.value.trim();
                if (city) {
                    setHomeCity(city);
                    showMainScreen();
                }
            }
        });

        function setHomeCity(city) {
            currentHomeCity = city;
            localStorage.setItem('homeCity', city);
            document.getElementById('userCityName').textContent = city;
            updateSurpriseCards(city);
        }

        function showMainScreen() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('mainScreen').classList.add('active');
            
            // Animate entrance
            setTimeout(() => {
                document.querySelectorAll('.surprise-card').forEach((card, i) => {
                    setTimeout(() => {
                        card.style.opacity = '0';
                        card.style.transform = 'translateY(20px)';
                        requestAnimationFrame(() => {
                            card.style.transition = 'all 0.5s ease-out';
                            card.style.opacity = '1';
                            card.style.transform = 'translateY(0)';
                        });
                    }, i * 100);
                });
            }, 100);
        }

        function detectLocation() {
            if (navigator.geolocation) {
                showLoading();
                navigator.geolocation.getCurrentPosition((position) => {
                    // Simulate reverse geocoding
                    setTimeout(() => {
                        hideLoading();
                        setHomeCity('San Francisco'); // Would use real geocoding
                        showMainScreen();
                    }, 1000);
                }, () => {
                    hideLoading();
                    alert('Please enter your city manually');
                });
            }
        }

        function surpriseMe() {
            const cities = Object.keys(cityData);
            const randomCity = cities[Math.floor(Math.random() * cities.length)];
            setHomeCity(randomCity);
            showMainScreen();
        }

        function changeHomeCity() {
            document.getElementById('mainScreen').classList.remove('active');
            document.getElementById('welcomeScreen').classList.remove('hidden');
        }

        function compareWith(city) {
            currentCompareCity = city;
            showComparison();
        }

        function showComparison() {
            const base = cityData[currentHomeCity] || cityData['San Francisco'];
            const overlay = cityData[currentCompareCity] || cityData['Tokyo'];
            
            // Update comparison display
            document.getElementById('baseCity').textContent = currentHomeCity || 'San Francisco';
            document.getElementById('overlayCity').textContent = currentCompareCity || 'Tokyo';
            
            // Calculate ratios
            const sizeRatio = (overlay.area / base.area).toFixed(1);
            const popRatio = (overlay.population / base.population).toFixed(1);
            const densityRatio = ((overlay.population/overlay.area) / (base.population/base.area)).toFixed(1);
            
            document.getElementById('sizeRatio').textContent = `${sizeRatio}x`;
            document.getElementById('popRatio').textContent = `${popRatio}x`;
            document.getElementById('densityRatio').textContent = `${densityRatio}x`;
            
            // Update visual sizes
            const baseSize = 100;
            const overlaySize = Math.min(200, baseSize * Math.sqrt(sizeRatio));
            
            document.getElementById('baseShape').style.width = `${baseSize}px`;
            document.getElementById('baseShape').style.height = `${baseSize}px`;
            document.getElementById('overlayShape').style.width = `${overlaySize}px`;
            document.getElementById('overlayShape').style.height = `${overlaySize}px`;
            
            // Generate fun fact
            const fact = generateFunFact(currentHomeCity, currentCompareCity, sizeRatio);
            document.getElementById('comparisonFact').innerHTML = fact;
            
            // Show comparison view
            document.getElementById('comparisonView').classList.add('active');
        }

        function generateFunFact(city1, city2, ratio) {
            if (ratio > 2) {
                return `${city2} is ${ratio} times larger than ${city1}! That's huge! ü§Ø`;
            } else if (ratio > 1.5) {
                return `${city2} is noticeably bigger than ${city1} - about ${ratio}x the size!`;
            } else if (ratio > 0.8 && ratio < 1.2) {
                return `Wow! ${city1} and ${city2} are almost the same size! City twins! üëØ`;
            } else {
                return `${city1} is actually larger than ${city2}! Surprised? üò≤`;
            }
        }

        function closeComparison() {
            document.getElementById('comparisonView').classList.remove('active');
        }

        function shareComparison() {
            if (navigator.share) {
                navigator.share({
                    title: 'City Size Comparison',
                    text: `Did you know? ${currentCompareCity} compared to ${currentHomeCity}!`,
                    url: window.location.href
                });
            } else {
                // Fallback
                showSuccess('Link copied to clipboard!');
            }
        }

        function findSimilarCities() {
            showCityModal('similar');
        }

        function compareNeighbors() {
            showCityModal('neighbors');
        }

        function compareCapitals() {
            showCityModal('capitals');
        }

        function guessingGame() {
            alert('Guessing game coming soon! üéÆ');
        }

        function showCityModal(filter) {
            document.getElementById('cityModal').classList.add('active');
        }

        function selectCity(city) {
            currentCompareCity = city;
            document.getElementById('cityModal').classList.remove('active');
            showComparison();
        }

        function switchTab(tab) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Haptic feedback
            if (navigator.vibrate) {
                navigator.vibrate(10);
            }
        }

        function updateSurpriseCards(city) {
            // Update surprise cards based on home city
            // This would be dynamic with real data
        }

        function showLoading() {
            document.getElementById('loadingSpinner').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingSpinner').classList.remove('active');
        }

        function showSuccess(message) {
            const popup = document.getElementById('successPopup');
            popup.classList.add('active');
            setTimeout(() => {
                popup.classList.remove('active');
            }, 2000);
        }

        function setupSwipeGestures() {
            let startY = 0;
            const modal = document.querySelector('.city-selector-modal');
            const modalOverlay = document.getElementById('cityModal');
            
            if (modal) {
                modal.addEventListener('touchstart', (e) => {
                    startY = e.touches[0].clientY;
                });
                
                modal.addEventListener('touchmove', (e) => {
                    const currentY = e.touches[0].clientY;
                    const diff = currentY - startY;
                    
                    if (diff > 0) {
                        modal.style.transform = `translateY(${diff}px)`;
                    }
                });
                
                modal.addEventListener('touchend', (e) => {
                    const currentY = e.changedTouches[0].clientY;
                    const diff = currentY - startY;
                    
                    if (diff > 100) {
                        modalOverlay.classList.remove('active');
                    }
                    modal.style.transform = '';
                });
            }
            
            // Close modal on overlay click
            modalOverlay?.addEventListener('click', (e) => {
                if (e.target === modalOverlay) {
                    modalOverlay.classList.remove('active');
                }
            });
        }

        function setupHapticFeedback() {
            // Add haptic feedback to all buttons
            document.querySelectorAll('button, .quick-compare-card, .surprise-card').forEach(el => {
                el.addEventListener('touchstart', () => {
                    if (navigator.vibrate) {
                        navigator.vibrate(5);
                    }
                });
            });
        }

        // Simulate real-time updates
        setInterval(() => {
            const stats = document.querySelectorAll('.surprise-stat');
            stats.forEach(stat => {
                // Add subtle animation
                stat.style.opacity = '0.5';
                setTimeout(() => {
                    stat.style.opacity = '1';
                }, 500);
            });
        }, 5000);
    </script>
</body>
</html>